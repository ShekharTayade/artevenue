{% extends 'artevenue/estore_base.html' %}
{% load static %}

{% block page-title %} 
<title>Arte'Venue | Generate Print Data</title>
{% endblock page-title %} 
  
{% block page-description %}
<meta name="description" content="Arte'Venue | Generate print data - Restricted Access.">
{% endblock page-description %}
  
{% block page-keywords %}
<meta name="keywords" content="artevenue, shipping template">
{% endblock page-keywords %}
  
{% block page-author %}
<meta name="author" content="Arte'Venue">
{% endblock page-author %}

{% block coursel-stylesheet %}
{% endblock coursel-stylesheet %}

{% block jqueryui-script %}
{% endblock jqueryui-script %}

{% block coursel-script %}
{% endblock coursel-script %}

{% block front.js %}
{% endblock front.js %}


{% block imagemap-resize-script %}
{% endblock imagemap-resize-script %}

{% load widget_tweaks %}

	<!-- Only Override the site content block -->
	{% block sitecontent %}

    <div id="all">
		<div id="content">
			<div class="container">
				<div class = "row">
					<div class="col-lg-12">
						<!-- breadcrumb-->
						<nav aria-label="breadcrumb">
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="{% url 'index' %}">Home</a></li>
								<li class="breadcrumb-item"><a href="{% url 'staff_page' %}">Staff Page</a></li>
								<li aria-current="page" class="breadcrumb-item active">Shipping Tempalte</li>
							</ol>
						</nav>
					</div>
				</div>
				<div class = "row">
					<div class = "col-12 text-center" >
						<h1 style = "font-weight:700;">GENERATE EXCEL DATA FOR PRINTING</h1>
					</div>				
					<div class = "col-12">
						<form style = "width: 100%;" id = "i_form" method = 'GET' action = "{% url 'generate_print_data_csv' %}">
							<div class = "row box">
								<div class = "col-12 mt-4 d-flex justify-content-center">
										<div class = "row">
											<div class = "col-12 col-md-4 text-center">
												<label class="radio-inline">
													<input id = "PC" type="radio" name="opt"
														value = "PC" checked
														onclick="$('#ord-num').hide();">
														Orders In Process 
												</label>
											</div>
											<div class = "col-12 col-md-4 text-center">
												<label class="radio-inline">
													<input id = "PR" type="radio" name="opt"
														value = "PR"
														onclick="$('#ord-num').hide();">
														Orders In Production 
												</label>
											</div>
											<div class = "col-12 col-md-4 text-center">
												<label class="radio-inline">
													<input id = "order_num_flag" type="radio" name="opt"
														value = "ORD_NUM_FLG"
														onclick="$('#ord-dt').hide(); $('#ord-num').show();">
														Order Number
												</label>
											</div>
										</div>
								</div>
							</div>
							<div class = "row"  id="ord-num" style = "display:none">
								<div class = "col-12  text-center">
									<div class="form-group">
										<label>Order Number(s):</label>
										<input name = "order_num" id = "order_num" class = "form-control" type="text" />
										<span style = "font-size:o.7rem;">Enter multiple orders separated by comma</span> 
									</div>
								</div>
							</div>
							<div class = "row"  id="ord-num">
								<div class = "col-12 text-center">
									<div class="form-group">
										<label>&nbsp; </label><br />
										<button type="submit" id = "date-submit" form = "i_form"
											class = "btn btn-primary"
											onclick = "">
											<i class = "fa fa-search"> Fetch</i>
										</button>
									</div>
								</div>
							</div>
						</form>
						<div id = "orders_table">
							{% include 'artevenue/print_data_table.html' %}
						</div>
						
						<div class="row box mt-5 mb-5">
							<form method = "GET" action = "{% url 'generate_print_data_csv'%}" id = "getcsv">
								<input hidden name = "printcsv" 
									id = "printcsv" value = "YES">
								<input hidden name = "print_for" 
									id = "print_for" value = "CANVAS">
								<input hidden name = "order_ids" id = "id_orders" 
									type="text"/>
								<div class = "col-12">
									<span style = "font-weight: 700;">DOWNLOAD EXCEL FILE FOR PRINTER</span>
								</div>
								<div class="row mt-3">
									<div class = "col-4 text-center">
										<label class="radio-inline">
											<input id = "CANVAS" type="radio" name="print_type"
												value = "CANVAS"
												onclick="$('#print_for').val('CANVAS');" checked>
												CANVAS
										</label>
									</div>
									<div class = "col-4 text-center">
										<label class="radio-inline">
											<input id = "PAPER" type="radio" name="print_type"
												value = "PAPER"
												onclick="$('#print_for').val('PAPER');" >
												PAPER
										</label>
									</div>
									<div class = "col-4 text-center">
										<button type="submit" id = "submit_pdf" 
										class = "btn btn-primary" form = "getcsv">
										<i class = "fa fa-download"> DOWNLOAD</i>
										</button>
									</div>
								</div>
							</form>
						</div>							
					</div>					
				</div>
			</div>
        </div>
    </div>
	{% include 'artevenue/message-modal_ok.html' %}
	{% endblock sitecontent %}


	{% block jscripts %}
		<script>
		function getButtons(){
			// Get the export buttons
			entTable = $('#ordTbl').DataTable( {
				fixedHeader: true,
				responsive: true,
				select: false,
				paging: true,
				dom: '<"top"f>Brt<"bottom"ilp><"clear">',
				buttons: [
				   'copy', 'excel', 'pdf', 'print'
				]
			} );
		}
		</script>
	
	<script>
		$( document ).ready(function() {
			var type = '{{search_type}}';
			if (type == 'PC') {
				$("#PC").prop('checked', true);
			}
			if (type == 'PR') {
				$("#PR").prop('checked', true);
			}
			if (type == 'ORD_NUM_FLG') {
				$("#order_num_flag").prop('checked', true);
				$('#order_num').val('{{order_num}}');
				$('#ord-num').show();
			}
			
			$('#select_all').click();
		});
			
	</script>


	<script>
		$('#getcsv').submit( function (e) {            		
			// Get all selected orders
			var ord_arr = []
			{% for o in order_list %}
				if ($('#id_{{o.order_id}}').prop('checked') == true ){
					ord_arr.push('{{o.order_id}}');
				}
			{% endfor %}
			$("#id_orders").val(ord_arr.toString());
			if (ord_arr.length < 1) {
				$("#msg").html("No orders selected!");
				$('#msg-modal').modal('show');	
				return false;
			}
			return true;
		});
	</script>
	
	<script>
		$('#select_all').change(function() {
			if (this.checked) {
				{% for o in order_list %}
					$('#id_{{o.order_id}}').prop('checked', true);					
				{% endfor %}
			} else {
				{% for o in order_list %}
					$('#id_{{o.order_id}}').prop('checked', false);					
				{% endfor %}			
			}
		});	
	</script>	
	{% endblock jscripts %}